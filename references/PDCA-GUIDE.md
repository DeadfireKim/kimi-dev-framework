# PDCA 가이드 v2.0

PDCA(Plan-Do-Check-Act)는 지속적인 개선을 위한 4단계 관리 방법론입니다.

---

## 4단계 사이클

### 1. Plan (계획) - `/pdca plan {feature}`

**목표**: 무엇을 만들 것인가? 어떻게 만들 것인가?

**실행 순서**:
1. `status.json` 확인 (초기화되지 않았으면 `/dev start` 안내)
2. PRD 문서 초안 생성
3. 사용자와 함께 PRD 검토 및 보완
4. 필요시 아키텍처 문서 생성
5. 백로그에 초기 스토리 목록 작성
6. 상태 업데이트: `pdca.stage` = "plan"

**활동**:
- 문제 정의 및 목표 설정
- 사용자 요구사항 분석
- PRD(Product Requirements Document) 작성
- 아키텍처 초안 설계
- 스토리 분할 및 우선순위 지정

**산출물**:
- `.kdf/active/prd-{feature}.md`
- `.kdf/active/arch-{feature}.md` (선택)
- `.kdf/backlog/stories/{feature}-*.md` (초안)

**완료 체크리스트**:
- [ ] 문제가 명확히 정의되었는가?
- [ ] 목표가 SMART한가? (Specific, Measurable, Achievable, Relevant, Time-bound)
- [ ] 사용자 페르소나가 정의되었는가?
- [ ] 핵심 시나리오가 식별되었는가?
- [ ] 기술적 제약사항이 파악되었는가?
- [ ] PRD가 팀원과 공유되었는가?

**다음 단계**: `/pdca do {feature}` 또는 `/pdca next`

---

### 2. Do (실행) - `/pdca do {feature}`

**목표**: 계획을 실행하고 작동하는 코드를 작성

**실행 순서**:
1. 현재 stage가 "plan" 완료 상태인지 검증
2. PRD 문서 읽기
3. 백로그 스토리 목록 확인
4. `/agile story`로 각 스토리 구현
5. 스토리별 체크리스트 업데이트
6. 상태 업데이트: `pdca.stage` = "do"

**활동**:
- 스토리별 구현
- 테스트 주도 개발(TDD)
- 지속적인 통합(CI)
- 문서화

**산출물**:
- 작동하는 코드
- 단위 테스트
- API 문서
- 변경 로그

**완료 체크리스트**:
- [ ] 스토리별로 구현이 완료되었는가?
- [ ] 테스트가 먼저 작성되었는가? (TDD)
- [ ] 코딩 컨벤션을 준수했는가?
- [ ] 에러 처리가 구현되었는가?
- [ ] 성능 고려사항이 반영되었는가?
- [ ] 문서가 업데이트되었는가?

**다음 단계**: `/pdca check {feature}` 또는 `/pdca next`

---

### 3. Check (점검) - `/pdca check {feature}`

**목표**: 결과를 평가하고 품질을 검증

**실행 순서**:
1. 구현된 코드 전체 검토
2. 테스트 실행 및 커버리지 확인
3. `/dev review` 실행
4. 품질 메트릭 수집 및 점수 계산 (0-100%)
5. 품질 보고서 생성
6. 상태 업데이트: `pdca.stage` = "check"

**활동**:
- 코드 리뷰
- 테스트 실행 및 커버리지 분석
- 정적 분석 (lint, type check)
- 성능 테스트
- 보안 검토

**산출물**:
- 코드 리뷰 결과
- 품질 메트릭 보고서
- 버그 리포트
- 개선사항 목록

**품질 임계값**:
| 지표 | 최소 | 권장 | 최적 |
|------|------|------|------|
| 테스트 커버리지 | 70% | 85% | 90% |
| 코드 리뷰 승인 | 1명 | 1명 | 2명 |
| 정적 분석 | 0 error | 0 warning | 0 issue |
| 성능 저하 | < 15% | < 10% | < 5% |
| **종합 품질 점수** | 70% | 85% | **90%** |

**완료 체크리스트**:
- [ ] 모든 테스트가 통과하는가?
- [ ] 코드 커버리지가 기준을 충족하는가?
- [ ] 코드 리뷰가 완료되었는가?
- [ ] 정적 분석 이슈가 없는가?
- [ ] 성능 기준을 만족하는가?
- [ ] 보안 취약점이 없는가?

**다음 단계 분기**:
- 품질 >= 90% → `/pdca next` → Complete
- 품질 < 90% → `/pdca act {feature}`

---

### 4. Act (개선) - `/pdca act {feature}`

**목표**: 점검 결과를 바탕으로 개선하고 표준화

**실행 순서**:
1. 품질 보고서 검토
2. 개선사항 우선순위 정렬 (P0/P1/P2/P3)
3. 개선 작업 수행
4. 개선 완료 후 자동 `/pdca check` 재실행
5. 반복 횟수 증가

**활동**:
- 식별된 문제 해결
- 리팩토링
- 문서 업데이트
- 프로세스 개선
- 다음 사이클 준비

**산출물**:
- 개선된 코드
- 업데이트된 문서
- 경험 교훈(Lessons Learned)
- 프로세스 개선안

**완료 체크리스트**:
- [ ] 모든 P0/P1 이슈가 해결되었는가?
- [ ] 리팩토링이 완료되었는가?
- [ ] 문서가 최신 상태인가?
- [ ] 회고가 진행되었는가?
- [ ] 다음 단계가 계획되었는가?

**종료 조건** (Quality-First 개선 루프):
1. 품질 점수 >= 90%
2. 반복 횟수 >= 5회 (강제 종료)
3. 사용자 수동 결정

**다음 단계**: `/pdca check {feature}` (재검증)

---

## Quality-First 개선 루프

품질 중심의 자동 개선 사이클입니다.

```
┌─────────┐     ┌─────────┐     ┌─────────┐
│  Check  │────→│   Act   │────→│  Check  │
│ (평가)  │     │ (개선)  │     │ (재평가)│
└────┬────┘     └─────────┘     └────┬────┘
     │                               │
     │      (점수 < 90%, 반복 < 5)   │
     └───────────────────────────────┘
     
     │      (점수 >= 90% 또는 반복 >= 5)
     ▼
┌───────────┐
│ Complete  │
│ (완료)    │
└───────────┘
```

**규칙**:
- 품질 점수 90% 이상이면 종료
- 최대 5회 반복 (무한 루프 방지)
- 각 반복마다 개선사항 기록
- `iterations` 카운터 증가

---

## PDCA 상태 전이 다이어그램

```
              ┌──────────┐
              │   Idle   │
              └────┬─────┘
                   │ /pdca plan {feature}
                   ▼
              ┌──────────┐
              │   Plan   │◄──────────────────────┐
              └────┬─────┘                       │
                   │ /pdca do                    │
                   ▼                             │
              ┌──────────┐                       │
              │    Do    │                       │
              └────┬─────┘                       │
                   │ /pdca check                 │
                   ▼                             │
              ┌──────────┐                       │
              │  Check   │                       │
              └────┬─────┘                       │
         ┌────────┴────────┐                     │
         │                 │                     │
   점수<90%              점수>=90%                │
         │                 │                     │
         ▼                 ▼                     │
    ┌──────────┐      ┌──────────┐               │
    │   Act    │─────→│ Complete │               │
    └──────────┘      └──────────┘               │
         │                                       │
         │ /pdca check (재검증)                   │
         └───────────────────────────────────────┘
```

---

## 품질 점수 계산법

### 가중치
| 항목 | 가중치 | 측정 방법 |
|------|--------|-----------|
| 기능 정확성 | 30% | 테스트 통과율, 요구사항 충족 |
| 코드 품질 | 25% | 정적 분석, 리뷰 결과 |
| 테스트 | 20% | 커버리지, 테스트 품질 |
| 성능 | 10% | 벤치마크 결과 |
| 보안 | 10% | 보안 검사 결과 |
| 문서화 | 5% | 문서 완성도 |

### 계산 예시
```
기능 정확성: 95/100 * 0.30 = 28.5
코드 품질:   90/100 * 0.25 = 22.5
테스트:      85/100 * 0.20 = 17.0
성능:        80/100 * 0.10 =  8.0
보안:       100/100 * 0.10 = 10.0
문서화:      90/100 * 0.05 =  4.5
─────────────────────────────────
총점:                              90.5%
```

---

## PDCA + Agile 통합

| PDCA 단계 | Agile 활동 | Kimi 명령어 |
|-----------|-----------|------------|
| Plan | 스프린트 계획, 스토리 작성 | `/agile sprint plan` |
| Do | 스토리 구현, 데일리 스크럼 | `/agile story {title}` |
| Check | 스프린트 리뷰, 코드 리뷰 | `/dev review` |
| Act | 백로그 정제, 프로세스 개선 | `/dev retro` |

### 통합 워크플로우 예시

```
# 스프린트 1 시작
/agile sprint plan --goal="결제 기능"

# PDCA: Plan
/pdca plan payment-system
→ PRD 작성
→ 아키텍처 설계

# PDCA: Do
/pdca do payment-system
→ /agile story create-payment
→ /agile story process-payment

# PDCA: Check
/pdca check payment-system
→ 코드 리뷰
→ 테스트 실행 (품질 87%)

# PDCA: Act
/pdca act payment-system
→ 테스트 추가
→ /pdca check (재실행, 품질 93%)

# 완료
/pdca next → Complete!
/agile sprint end
/dev retro
```

---

## 모범 사례

### Plan 단계
- 충분한 시간 투자 (전체의 30-40%)
- 다이어그램과 시각화를 활용
- 위험 요소를 미리 식별
- 스테이크홀더와 PRD 검토

### Do 단계
- 작은 단위로 나누어 진행
- 지속적으로 커밋 (atomic commits)
- 문서화를 병행
- 블로커(장애물)는 즉시 공유

### Check 단계
- 객관적인 메트릭 사용
- 품질 점수 90%를 목표로
- 기술 부채를 별도로 기록

### Act 단계
- 완벽보다 개선에 초점
- 학습 내용 문서화
- 다음 사이클에 적용할 것 계획
- 반복 횟수 제한 준수 (최대 5회)

---

## 문제 해결 가이드

### 품질 점수가 90%에 도달하지 않는 경우

**원인 분석**:
1. 테스트 커버리지 부족 → 테스트 추가
2. 정적 분석 이슈 → 리팩토링
3. 성능 이슈 → 최적화
4. 문서 부족 → 문서 보완

**접근법**:
1. P0/P1 이슈 우선 해결
2. 점진적 개선 (한 번에 모든 것을 고치려 하지 말 것)
3. 5회 반복 후에도 미달시 수동 판단

### PDCA가 무한 루프에 빠지는 경우

**해결책**:
- 5회 반복 제한 확인
- 수동으로 `/pdca-set complete` 실행
- 품질 기준 현실적으로 조정
